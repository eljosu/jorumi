# ğŸ“Š JORUMI Game Engine - Diagramas y Visualizaciones

## Diagrama de Arquitectura General

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         UI LAYER                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚    React     â”‚  â”‚   Three.js   â”‚  â”‚   Controls   â”‚         â”‚
â”‚  â”‚  Components  â”‚  â”‚   Rendering  â”‚  â”‚   & Input    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                 â”‚                  â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                           â”‚                                     â”‚
â”‚                    Read State Only                              â”‚
â”‚                           â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      GAME ENGINE                                â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    GameEngine Class                       â”‚  â”‚
â”‚  â”‚  â€¢ startGame()   â€¢ applyAction()   â€¢ getState()          â”‚  â”‚
â”‚  â”‚  â€¢ saveGame()    â€¢ loadGame()      â€¢ advancePhase()      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                       â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    â–¼                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚           Action Reducer                         â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  validateAction() â†’ reduceAction() â†’ newState    â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚   Domain     â”‚  â”‚    Rules     â”‚  â”‚   Actions    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   Types      â”‚  â”‚  Game Rules  â”‚  â”‚  Validators  â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚    Dice      â”‚  â”‚    Utils     â”‚  â”‚    Phase     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   System     â”‚  â”‚   Helpers    â”‚  â”‚   Machine    â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    GameState                              â”‚  â”‚
â”‚  â”‚  Immutable â€¢ Serializable â€¢ Deterministic                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Flujo de AcciÃ³n Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Click  â”‚
â”‚   on UI     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create GameAction  â”‚
â”‚  {                  â”‚
â”‚    type: MOVE,      â”‚
â”‚    playerId: "123", â”‚
â”‚    data: {...}      â”‚
â”‚  }                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ engine.applyAction  â”‚
â”‚     (action)        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ validateAction()    â”‚â”€â”€â”€â”€â–¶â”‚  Invalid?   â”‚â”€â”€â–¶ Return error
â”‚                     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â€¢ Check phase       â”‚
â”‚ â€¢ Check resources   â”‚
â”‚ â€¢ Check distance    â”‚
â”‚ â€¢ Check permissions â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Valid
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  reduceAction()     â”‚
â”‚                     â”‚
â”‚ â€¢ Clone state       â”‚
â”‚ â€¢ Apply changes     â”‚
â”‚ â€¢ Generate events   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Apply Game Rules   â”‚
â”‚                     â”‚
â”‚ â€¢ Food consumption  â”‚
â”‚ â€¢ Alien control     â”‚
â”‚ â€¢ Victory check     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Return Result     â”‚
â”‚  {                  â”‚
â”‚    success: true,   â”‚
â”‚    newState: {...}, â”‚
â”‚    events: [...]    â”‚
â”‚  }                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Update UI State    â”‚
â”‚  setState(newState) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Process Events      â”‚
â”‚                     â”‚
â”‚ â€¢ Animations        â”‚
â”‚ â€¢ Notifications     â”‚
â”‚ â€¢ Sound effects     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## MÃ¡quina de Estados de Fases

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   START GAME     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   PREPARATION    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          â”‚                  â”‚          â”‚
         â”‚          â”‚ â€¢ Reset chars    â”‚          â”‚
         â”‚          â”‚ â€¢ Consume food   â”‚          â”‚
         â”‚          â”‚ â€¢ Care wounded   â”‚          â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚                   â”‚                    â”‚
         â”‚                   â–¼                    â”‚
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
         â”‚          â”‚   EXPLORATION    â”‚          â”‚
         â”‚          â”‚                  â”‚          â”‚
         â”‚          â”‚ â€¢ Place tiles    â”‚          â”‚
         â”‚          â”‚ â€¢ Explore map    â”‚          â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚                   â”‚                    â”‚
         â”‚                   â–¼                    â”‚
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
         â”‚          â”‚    MOVEMENT      â”‚          â”‚
         â”‚          â”‚                  â”‚          â”‚
         â”‚          â”‚ â€¢ Move chars     â”‚          â”‚
         â”‚          â”‚ â€¢ Validate range â”‚          â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚                   â”‚                    â”‚
         â”‚                   â–¼                    â”‚
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
         â”‚          â”‚ RESOURCE_GATHER  â”‚          â”‚
         â”‚          â”‚                  â”‚          â”‚
         â”‚          â”‚ â€¢ Gather food    â”‚          â”‚
         â”‚          â”‚ â€¢ Mine resources â”‚          â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚                   â”‚                    â”‚
         â”‚                   â–¼                    â”‚
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
         â”‚          â”‚     TRADING      â”‚          â”‚
         â”‚          â”‚                  â”‚          â”‚
         â”‚          â”‚ â€¢ Transfer       â”‚          â”‚
         â”‚          â”‚ â€¢ Convert        â”‚          â”‚
         â”‚          â”‚ â€¢ Build          â”‚          â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚                   â”‚                    â”‚
         â”‚                   â–¼                    â”‚
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
         â”‚          â”‚   ALIEN_TURN     â”‚          â”‚
         â”‚          â”‚                  â”‚          â”‚
         â”‚          â”‚ â€¢ Roll dice      â”‚          â”‚
         â”‚          â”‚ â€¢ Attack/Control â”‚          â”‚
         â”‚          â”‚ â€¢ Move alien     â”‚          â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚                   â”‚                    â”‚
         â”‚                   â–¼                    â”‚
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
         â”‚          â”‚   ROLE_CHECK     â”‚          â”‚
         â”‚          â”‚                  â”‚          â”‚
         â”‚          â”‚ â€¢ Check control  â”‚          â”‚
         â”‚          â”‚ â€¢ Change roles   â”‚          â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚                   â”‚                    â”‚
         â”‚                   â–¼                    â”‚
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
         â”‚          â”‚ END_GAME_CHECK   â”‚          â”‚
         â”‚          â”‚                  â”‚          â”‚
         â”‚          â”‚ â€¢ Check victory  â”‚          â”‚
         â”‚          â”‚ â€¢ Check defeat   â”‚          â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚                   â”‚                    â”‚
         â”‚                   â”‚ Not over           â”‚
         â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                   â”‚
         â”‚                   â”‚ Game Over
         â”‚                   â–¼
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          â”‚    GAME OVER     â”‚
         â”‚          â”‚                  â”‚
         â”‚          â”‚ â€¢ Show results   â”‚
         â”‚          â”‚ â€¢ Save stats     â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â”€â”€â”€ New Turn (increment turn counter)
```

## Estructura de GameState

```
GameState
â”œâ”€â”€ gameId: string
â”œâ”€â”€ turn: number
â”œâ”€â”€ phase: GamePhase
â”œâ”€â”€ currentPlayerId: PlayerId
â”‚
â”œâ”€â”€ players: Player[]
â”‚   â””â”€â”€ Player
â”‚       â”œâ”€â”€ id: string
â”‚       â”œâ”€â”€ name: string
â”‚       â””â”€â”€ role: PlayerRole (HUMAN | ALIEN)
â”‚
â”œâ”€â”€ tiles: Map<TileId, Tile>
â”‚   â””â”€â”€ Tile
â”‚       â”œâ”€â”€ id: string
â”‚       â”œâ”€â”€ type: TileType
â”‚       â”œâ”€â”€ coordinates: HexCoordinates (q, r, s)
â”‚       â”œâ”€â”€ explored: boolean
â”‚       â”œâ”€â”€ destroyed: boolean
â”‚       â”œâ”€â”€ building?: BuildingType
â”‚       â””â”€â”€ resources?: ResourceInventory
â”‚
â”œâ”€â”€ ghettos: Map<GhettoId, Ghetto>
â”‚   â””â”€â”€ Ghetto
â”‚       â”œâ”€â”€ id: string
â”‚       â”œâ”€â”€ name: string
â”‚       â”œâ”€â”€ tileId: TileId
â”‚       â”œâ”€â”€ controlStatus: GhettoControlStatus
â”‚       â”œâ”€â”€ population: number
â”‚       â”œâ”€â”€ wounded: number
â”‚       â”œâ”€â”€ resources: ResourceInventory
â”‚       â”‚   â”œâ”€â”€ FOOD: number
â”‚       â”‚   â”œâ”€â”€ MEDICINE: number
â”‚       â”‚   â”œâ”€â”€ METAL: number
â”‚       â”‚   â””â”€â”€ MINERALS: number
â”‚       â”œâ”€â”€ buildings: BuildingType[]
â”‚       â””â”€â”€ characters: CharacterId[]
â”‚
â”œâ”€â”€ characters: Map<CharacterId, Character>
â”‚   â””â”€â”€ Character
â”‚       â”œâ”€â”€ id: string
â”‚       â”œâ”€â”€ type: CharacterType
â”‚       â”œâ”€â”€ name: string
â”‚       â”œâ”€â”€ ghettoId: GhettoId
â”‚       â”œâ”€â”€ tileId?: TileId
â”‚       â”œâ”€â”€ isWounded: boolean
â”‚       â”œâ”€â”€ isUsed: boolean
â”‚       â””â”€â”€ canAct: boolean
â”‚
â”œâ”€â”€ alien: AlienState
â”‚   â”œâ”€â”€ shieldLevel: number
â”‚   â”œâ”€â”€ controlTokens: number
â”‚   â”œâ”€â”€ mothershipHealth: number
â”‚   â”œâ”€â”€ mothershipShield: number
â”‚   â”œâ”€â”€ currentTileId?: TileId
â”‚   â””â”€â”€ hasAuxiliaryShip: boolean
â”‚
â”œâ”€â”€ actionsThisTurn: string[]
â”œâ”€â”€ gameOver: boolean
â”œâ”€â”€ victoryCondition?: VictoryCondition
â”œâ”€â”€ winner?: PlayerRole
â”œâ”€â”€ rngSeed: number
â””â”€â”€ rngState: number
```

## Flujo de ValidaciÃ³n

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   GameAction     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ validateAction() â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Global Checks â”‚   â”‚ Phase Checks  â”‚   â”‚ Action Checks â”‚
â”‚               â”‚   â”‚               â”‚   â”‚               â”‚
â”‚ â€¢ Game over?  â”‚   â”‚ â€¢ Valid phase?â”‚   â”‚ â€¢ Resources?  â”‚
â”‚ â€¢ Player turn?â”‚   â”‚ â€¢ Can advance?â”‚   â”‚ â€¢ Distance?   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                    â”‚                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   All Valid?     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                         â”‚
                â–¼                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Return Valid â”‚         â”‚ Return Invalidâ”‚
        â”‚  { valid: true}â”‚         â”‚ { valid: falseâ”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   reason: "..." }â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Sistema de Dados

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   DiceManager    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ roll(type, rng)
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AlienAttack   â”‚   â”‚ AlienAction   â”‚   â”‚   Human D6    â”‚
â”‚     Dice      â”‚   â”‚     Dice      â”‚   â”‚     Dice      â”‚
â”‚               â”‚   â”‚               â”‚   â”‚               â”‚
â”‚ Faces:        â”‚   â”‚ Faces:        â”‚   â”‚ Faces:        â”‚
â”‚ â€¢ SHIELD (2x) â”‚   â”‚ â€¢ MOVE (2x)   â”‚   â”‚ â€¢ 1, 2, 3,    â”‚
â”‚ â€¢ CONTROL     â”‚   â”‚ â€¢ SCAN (2x)   â”‚   â”‚   4, 5, 6     â”‚
â”‚ â€¢ ATTACK (2x) â”‚   â”‚ â€¢ BOMB        â”‚   â”‚               â”‚
â”‚ â€¢ DOUBLE_ATK  â”‚   â”‚ â€¢ SPECIAL     â”‚   â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                    â”‚                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  RandomGenerator â”‚
                    â”‚                  â”‚
                    â”‚ â€¢ LCGRandom      â”‚
                    â”‚ â€¢ FixedRandom    â”‚
                    â”‚ â€¢ Seedeable      â”‚
                    â”‚ â€¢ Serializable   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Coordenadas Hexagonales

```
Sistema Axial (q, r, s) donde q + r + s = 0

        (-1,-1,2)   (0,-1,1)
              \     /
               \   /
        (-1,0,1) (0,0,0) (1,0,-1)
               /   \
              /     \
        (0,1,-1)   (1,1,-2)

ConversiÃ³n a Cartesiano:
  x = q * 1.5
  z = r * âˆš3 + (q * âˆš3 / 2)

Distancia entre hexÃ¡gonos:
  distance = (|q1-q2| + |r1-r2| + |s1-s2|) / 2

Adyacentes (6 direcciones):
  (+1, 0,-1)  (+1,-1, 0)
  ( 0,-1,+1)  ( 0,+1,-1)
  (-1, 0,+1)  (-1,+1, 0)
```

## Flujo de Supervivencia

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  PREPARATION     â”‚
                    â”‚     Phase        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ For each Ghetto  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Food Check    â”‚   â”‚ Medicine Checkâ”‚   â”‚ Update State  â”‚
â”‚               â”‚   â”‚               â”‚   â”‚               â”‚
â”‚ Need: pop*1   â”‚   â”‚ Need: wound*1 â”‚   â”‚ â€¢ Deaths      â”‚
â”‚               â”‚   â”‚               â”‚   â”‚ â€¢ Healed      â”‚
â”‚ Have: food    â”‚   â”‚ Have: medicineâ”‚   â”‚ â€¢ Resources   â”‚
â”‚               â”‚   â”‚               â”‚   â”‚               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚               â”‚
â”‚ â”‚ Enough?   â”‚ â”‚   â”‚ â”‚ Enough?   â”‚ â”‚   â”‚               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚   â”‚               â”‚
â”‚       â”‚       â”‚   â”‚       â”‚       â”‚   â”‚               â”‚
â”‚  Yes  â”‚  No   â”‚   â”‚  Yes  â”‚  No   â”‚   â”‚               â”‚
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚               â”‚
â”‚   â”‚   â”‚   â””â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â–¶â”‚ Calculate     â”‚
â”‚   â”‚   â”‚       â”‚   â”‚   â”‚   â”‚       â”‚   â”‚ Deaths        â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â–¶â”‚               â”‚
â”‚   â”‚           â”‚   â”‚   â”‚   â”‚       â”‚   â”‚               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â–¶â”‚ All Survive   â”‚
â”‚               â”‚   â”‚   â”‚   â”‚       â”‚   â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â–¶â”‚ Heal All      â”‚
                    â”‚   â”‚           â”‚   â”‚               â”‚
                    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â–¶â”‚ Some Die      â”‚
                    â”‚               â”‚   â”‚               â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚ Updated Ghettoâ”‚
                                        â”‚ â€¢ New pop     â”‚
                                        â”‚ â€¢ New wounded â”‚
                                        â”‚ â€¢ New resourcesâ”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Multiplayer SincronizaciÃ³n

```
Cliente A                Servidor               Cliente B
    â”‚                       â”‚                       â”‚
    â”‚â”€â”€â”€ Action â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                       â”‚
    â”‚   {move char}         â”‚                       â”‚
    â”‚                       â”‚                       â”‚
    â”‚                       â”‚â”€â”€ Validate â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚                       â”‚                  â”‚    â”‚
    â”‚                       â”‚â—€â”€ Valid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
    â”‚                       â”‚                       â”‚
    â”‚                       â”‚â”€â”€â”€ Broadcast â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
    â”‚                       â”‚   {move char}         â”‚
    â”‚                       â”‚                       â”‚
    â”‚â—€â”€â”€ Confirmation â”€â”€â”€â”€â”€â”€â”‚                       â”‚
    â”‚                       â”‚                       â”‚
    â”‚                       â”‚                       â”‚
    â”‚   Apply Locally       â”‚   Apply & Store       â”‚   Apply Remotely
    â”‚                       â”‚                       â”‚
    â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ State A  â”‚          â”‚ State S  â”‚            â”‚ State B  â”‚
â”‚ (updated)â”‚          â”‚ (master) â”‚            â”‚ (updated)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”‚                       â”‚                       â”‚
    â”‚                       â”‚                       â”‚
    â”‚                  Periodic Sync                â”‚
    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Hash Check â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
    â”‚                       â”‚                       â”‚
    â”‚                                               â”‚
    â”‚â”€â”€â”€ Desync Detected? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                       â”‚                       â”‚
    â”‚â—€â”€â”€â”€ Request Full State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
    â”‚                       â”‚                       â”‚
    â”‚â—€â”€â”€â”€â”€â”€â”€ Send State â”€â”€â”€â”€â”¤                       â”‚
    â”‚                       â”‚                       â”‚
    â–¼                       â–¼                       â–¼
  Synced                  Master                  Synced
```

## JerarquÃ­a de Tipos

```
GameAction (base)
â”œâ”€â”€ StartGameAction
â”œâ”€â”€ EndTurnAction
â”œâ”€â”€ AdvancePhaseAction
â”œâ”€â”€ ExploreTileAction
â”œâ”€â”€ PlaceTileAction
â”œâ”€â”€ MoveCharacterAction
â”œâ”€â”€ MoveAlienAction
â”œâ”€â”€ GatherResourcesAction
â”œâ”€â”€ ConsumeFoodAction
â”œâ”€â”€ BuildStructureAction
â”œâ”€â”€ HealWoundedAction
â”œâ”€â”€ TransferResourcesAction
â”œâ”€â”€ ConvertResourcesAction
â”œâ”€â”€ AttackAlienAction
â”œâ”€â”€ AttackMothershipAction
â”œâ”€â”€ DefendAction
â”œâ”€â”€ AlienAttackAction
â”œâ”€â”€ AlienControlGhettoAction
â”œâ”€â”€ AlienBombAction
â”œâ”€â”€ AlienScanAction
â”œâ”€â”€ ChangeRoleAction
â”œâ”€â”€ ActivateBeaconAction
â”œâ”€â”€ EscapeShipAction
â””â”€â”€ EndGameAction

CharacterType
â”œâ”€â”€ DOCTOR      â†’ Heals wounded
â”œâ”€â”€ SOLDIER     â†’ Attacks alien
â”œâ”€â”€ PEASANT     â†’ Gathers food (3)
â”œâ”€â”€ CONSTRUCTOR â†’ Builds structures
â””â”€â”€ MINER       â†’ Gathers minerals/metal (2 each)

ResourceType
â”œâ”€â”€ FOOD        â†’ Survival (1 per human/turn)
â”œâ”€â”€ MEDICINE    â†’ Healing (1 per wounded)
â”œâ”€â”€ METAL       â†’ Construction
â””â”€â”€ MINERALS    â†’ Victory condition (beacon)

BuildingType
â”œâ”€â”€ BUNKER      â†’ Defense (-2 damage)
â”œâ”€â”€ HOSPITAL    â†’ Healing (+2 bonus)
â”œâ”€â”€ WORKSHOP    â†’ Resource conversion
â””â”€â”€ BEACON      â†’ Victory condition
```

---

**Estos diagramas ilustran la arquitectura completa del motor de JORUMI**


